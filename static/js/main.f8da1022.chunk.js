(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"account",function(){return y}),a.d(n,"apiConf",function(){return N}),a.d(n,"auth",function(){return j}),a.d(n,"search",function(){return O}),a.d(n,"watchlist",function(){return k});var r=a(49),s=a(2),c=a.n(s),i=a(4),u=a(26),o=a(27),l=a(50),m=a.n(l),h=a(28),d=a.n(h),f=function(e){console.warn("[Notify]",e),window.alert(e)},A=window.localStorage,p=function(e){try{return JSON.parse(A.getItem(e))}catch(t){return f(t),null}},v=function(e,t){try{A.setItem(e,JSON.stringify(t))}catch(a){f(a)}},b=function(e){A.removeItem(e)},g="__TMDB_SESSION_ID__",w=function(){b(g);var e=window.location;e.assign(e.href.split("?")[0])};a(87);function E(e){e.baseURL="https://api.themoviedb.org/3",e.params=Object(o.a)(Object(u.a)({},"api_key","76c088fdd2e476339989606801b08288"),e.params);var t=C.getState().auth.sessionId;return t&&(e.params.session_id=t),d.a.start(),m()(e).then(function(e){return d.a.done(),e.data}).catch(function(e){if(e.response){var t=e.response,a=t.data;f("string"===typeof a?a:"[".concat(a.status_code,"] ").concat(a.status_message)),401===t.status&&w()}else f(e.message);throw d.a.done(!0),e})}var y={state:{id:null,name:"",username:"",include_adult:!1,iso_639_1:"",iso_3166_1:"",avatar:{gravatar:{hash:""}}},reducers:{updateInfo:function(e,t){return t}},effects:{syncInfo:function(){var e=Object(i.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({url:"/account"});case 2:t=e.sent,this.updateInfo(t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},N={state:{images:{base_url:"",secure_base_url:"",poster_sizes:[],backdrop_sizes:[],logo_sizes:[],profile_sizes:[],still_sizes:[]},change_keys:[]},reducers:{updateConf:function(e,t){return t}},effects:{syncConf:function(){var e=Object(i.a)(c.a.mark(function e(){var t;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({url:"/configuration"});case 2:t=e.sent,this.updateConf(t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},j={state:{sessionId:p(g)},reducers:{updateSessionId:function(e,t){return v(g,t),{sessionId:t}}},effects:{ensureAuthed:function(e,t){if(!t.auth.sessionId){var a=new URLSearchParams(window.location.search);if(a.has("request_token")){if("true"===a.get("approved"))return this._fetchNewSessionId(a.get("request_token"));var n="You did not authorize the app to access your TMDb account";throw f(n),new Error(n)}throw new Error("Please call authNow to continue")}},authNow:function(){if(b(g),window.confirm("You will be redirected to TMDb to approve the authorization"))return this._fetchNewReqToken();f("You cancelled the auth request, please refresh the page to retry")},_fetchNewReqToken:function(){var e=Object(i.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({url:"/authentication/token/new"});case 2:t=e.sent,a=t.request_token,this.askForAuth(a);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),askForAuth:function(e){var t=window.location,a=t.href.split("?")[0];t.assign("https://www.themoviedb.org/authenticate/".concat(e,"?redirect_to=").concat(a))},_fetchNewSessionId:function(){var e=Object(i.a)(c.a.mark(function e(t){var a,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E({method:"post",url:"/authentication/session/new",data:{request_token:t}});case 2:a=e.sent,n=a.session_id,this.updateSessionId(n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},O={state:{query:"",curPage:null,totalPage:null,isLoading:!1,results:[]},reducers:{setState:function(e,t){return Object(o.a)({},e,t)}},effects:{search:function(){var e=Object(i.a)(c.a.mark(function e(t){var a,n,r,s,i,u,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.query,n=t.page,r=void 0===n?1:n,this.setState({isLoading:!0}),e.next=4,E({url:"/search/tv",params:{query:a,page:r}});case 4:s=e.sent,i=s.page,u=s.results,o=s.total_pages,this.setState({query:a,curPage:i,totalPage:o,results:u,isLoading:!1});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),goPrevPage:function(e,t){var a=t.search,n=a.query,r=a.curPage;return this.search({query:n,page:r-1})},goNextPage:function(e,t){var a=t.search,n=a.query,r=a.curPage;return this.search({query:n,page:r+1})}}},_=a(36),k={state:[],reducers:{updateWatchlist:function(e,t){return t}},effects:{syncWatchlist:function(){var e=Object(i.a)(c.a.mark(function e(t,a){var n,r,s,i,u,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=1,s=1;case 3:if(!(r<=s)){e.next=14;break}return e.next=6,E({url:"/account/".concat(a.account.id,"/watchlist/tv"),params:{page:r}});case 6:i=e.sent,u=i.results,o=i.total_pages,n.push.apply(n,Object(_.a)(u)),s=o,r+=1,e.next=3;break;case 14:this.updateWatchlist(n);case 15:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),add:function(){var e=Object(i.a)(c.a.mark(function e(t,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._upd({id:t.id,isWatched:!0});case 2:this.updateWatchlist([].concat(Object(_.a)(a.watchlist),[t]));case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),rm:function(){var e=Object(i.a)(c.a.mark(function e(t,a){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._upd({id:t,isWatched:!1});case 2:this.updateWatchlist(a.watchlist.filter(function(e){return e.id!==t}));case 3:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),_upd:function(e,t){var a=e.id,n=e.isWatched;return E({method:"post",url:"/account/".concat(t.account.id,"/watchlist"),data:{media_type:"tv",media_id:a,watchlist:n}})}}};a.d(t,"b",function(){return B});var x=Object(r.init)({models:n}),C=t.a=x,B=x.dispatch},25:function(e,t,a){"use strict";t.a=function(e){return e?e.substr(0,4):"-"}},31:function(e,t,a){"use strict";var n=a(1),r=Object(n.shape)({poster_path:n.string,popularity:n.number.isRequired,id:n.number.isRequired,backdrop_path:n.string,vote_average:n.number.isRequired,overview:n.string.isRequired,first_air_date:n.string,original_language:n.string.isRequired,vote_count:n.number.isRequired,name:n.string.isRequired});Object(n.arrayOf)(r)},51:function(e,t){e.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQUFBAYFBQUHBgYHCQ8KCQgICRMNDgsPFhMXFxYTFRUYGyMeGBohGhUVHikfISQlJygnGB0rLismLiMmJyb/2wBDAQYHBwkICRIKChImGRUZJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJiYmJib/wgARCAB3AHgDAREAAhEBAxEB/8QAGQABAQEBAQEAAAAAAAAAAAAAAAMCBAEI/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAPpgAAAAAAAAAAAAAAAGiooAAIETwAFTB4AeAAoeGAAWJlDqOc5wAUPDAALEyh1nOcwKGDZ4YABYmZPTwGjtMnMeGAAWJmQVMnUUBM5TAALEzJQ7DJI6ADhMAAsTB2mgSPCwOEwACxM6ygAIGyhwmAAVNmgAAZKHMYAB6egAAAGQAAAAAAAAAAAAAAAD/8QAKBAAAgEBBwMFAQEAAAAAAAAAAQIAAwQREjNRUnEQFCAhMTJBgWFQ/9oACAEBAAE/AP8AApoXa4ECdu24Tt33Cdu+4Tt33Cdu+4Tt33Cdu+4Ttn3Cdu26OMLFfGy5v5HJxt6n3l53GeurT13GXnUy86mXnUy86mUM0esrZr8+NlzY/wA25lmQMxJ+oAJaKYFzL40M1ZWzX58bLmx/m3MszBSVP30tLi7D+9aNM1DoBGUoSDKGasrZr8+NlzY/zbnpjfcetNC5uiKEW4SrTDqdZQzgJWzX58bLmx/m3PWhSxHE3tKlMo131KKYF/v31NMFw49xK+a/PjZc2P8ANuelGnjb+D3gAAuEqIHUqZRYoTSf8PhWzX58bLmx/m3MRS7YREQItw61qeNdGEoVMQKt6MOtfNfnxsubCCarAayjTFNf6ffxrUz80+QlGpjX+j36V81+fGzZv5BSqhyy4f2XWnVZdadVl1p1WXWnVZdadVl1o1WClWDFgVBiCviGMgiVs1+fEEjUTG24zG24zG24zG24zG24zG24zG24zG24zG+4/wCF/8QAFBEBAAAAAAAAAAAAAAAAAAAAcP/aAAgBAgEBPwBh/8QAFBEBAAAAAAAAAAAAAAAAAAAAcP/aAAgBAwEBPwBh/9k="},54:function(e,t,a){e.exports=a(90)},89:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(18),c=a(14),i=a(5),u=a(6),o=a(10),l=a(9),m=a(11),h=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){a.setState({keywords:e.target.value})},a.handleSubmit=function(e){e.preventDefault(),a.props.onSearch(a.state.keywords)},a.state={keywords:e.query},a}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.keywords;return r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"field has-addons",style:{justifyContent:"flex-end"}},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement("i",{className:"fas fa-search"})),r.a.createElement("input",{className:"input",placeholder:"Search TV Shows...",onChange:this.handleChange,value:e,required:!0})),r.a.createElement("div",{className:"control"},r.a.createElement("button",{type:"submit",className:"button is-primary"},"Search"))))}}]),t}(r.a.Component),d=Object(c.b)(function(e){return{query:e.search.query}},function(e){return{onSearch:function(t){return e.search.search({query:t})}}})(h),f=a(37),A=(a(31),a(25)),p=a(53),v=a(48),b=a.n(v),g=a(16),w=a(51),E=a.n(w),y=function(e,t,a){if(!e)return E.a;var n=g.a.getState().apiConf.images,r=n.secure_base_url,s=n["".concat(t,"_sizes")];return a&&!s.includes(a)&&(console.warn("[".concat(t,"] ").concat(a," is not in the available sizes: ").concat(s)),a=null),b()(r,a||s[0],e)},N=[["Cover","poster_path",function(e,t){return r.a.createElement("img",{style:{width:"100px",height:"100px"},alt:t.name,src:y(e,"poster")})}],["Title","name"],["Year","first_air_date",A.a],["Rate","vote_average",function(e){return e+"%"}],["Lang","original_language",function(e){return p.a.getName(e)}]],j=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"renderNoResultsRow",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:N.length+1,className:"has-text-centered has-text-grey"},"(No results)"))}},{key:"renderResultRows",value:function(){var e=this.props,t=e.results,a=e.watchlist,n=e.addToWatchList,s=e.rmFromWatchList;return t.map(function(e){return r.a.createElement("tr",{key:e.id},N.map(function(t){var a=Object(f.a)(t,3),n=(a[0],a[1]),s=a[2];return r.a.createElement("td",{key:n},s?s(e[n],e):e[n])}),r.a.createElement("td",null,(t=e.id,a.find(function(e){return e.id===t})?r.a.createElement("button",{"aria-label":"remove from watchlist",className:"button is-danger is-outlined",onClick:function(){return s(e.id)}},r.a.createElement("span",{className:"icon is-small"},r.a.createElement("i",{className:"fas fa-trash"}))):r.a.createElement("button",{"aria-label":"add to watchlist",className:"button is-link is-outlined",onClick:function(){return n(e)}},r.a.createElement("span",{className:"icon is-small"},r.a.createElement("i",{className:"fas fa-plus"}))))));var t})}},{key:"render",value:function(){var e=this.props.results;return r.a.createElement("table",{className:"table is-fullwidth"},r.a.createElement("thead",null,r.a.createElement("tr",null,N.map(function(e){var t=Object(f.a)(e,2),a=t[0],n=t[1];return r.a.createElement("td",{key:n},a)}),r.a.createElement("td",null,"Add / Remove Watchlist"))),r.a.createElement("tbody",null,e.length?this.renderResultRows():this.renderNoResultsRow()))}}]),t}(r.a.Component),O=Object(c.b)(function(e){return{watchlist:e.watchlist,results:e.search.results}},function(e){return{addToWatchList:function(t){return e.watchlist.add(t)},rmFromWatchList:function(t){return e.watchlist.rm(t)}}})(j),_=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.curPage,a=e.totalPage,n=e.isLoading,s=e.goPrevPage,c=e.goNextPage;return r.a.createElement("nav",{className:"pagination is-centered",role:"navigation","aria-label":"pagination"},r.a.createElement("button",{className:"pagination-previous",onClick:s,disabled:n||+t<=1},"Previous"),r.a.createElement("span",{className:"pagination-list"},t," / ",a),r.a.createElement("button",{className:"pagination-next",onClick:c,disabled:n||t===a},"Next page"))}}]),t}(r.a.Component),k=Object(c.b)(function(e){var t=e.search;return{curPage:t.curPage,totalPage:t.totalPage,isLoading:t.isLoading}},function(e){var t=e.search;return{goPrevPage:t.goPrevPage,goNextPage:t.goNextPage}})(_),x=function(){return r.a.createElement("section",null,r.a.createElement(O,null),r.a.createElement(k,null))};t.default=function(){return r.a.createElement("section",null,r.a.createElement(s.Helmet,null,r.a.createElement("title",null,"Home")),r.a.createElement(d,null),r.a.createElement("br",null),r.a.createElement(x,null))}},90:function(e,t,a){"use strict";a.r(t);var n=a(2),r=a.n(n),s=a(4),c=a(0),i=a.n(c),u=a(23),o=a.n(u),l=a(14),m=a(18),h=a(22),d=a(17),f=a(5),A=a(6),p=a(10),v=a(9),b=a(11),g=a(33),w=a.n(g),E=[{title:"Home",path:"/",exact:!0,component:a(89).default},{title:"Watch List",path:"/watchlist",component:a(91).default}],y=function(e){function t(e){var a;return Object(f.a)(this,t),(a=Object(p.a)(this,Object(v.a)(t).call(this,e))).toggleNavMenu=function(e){e.preventDefault(),a.setState({isNavMenuVisible:!a.state.isNavMenuVisible})},a.state={isNavMenuVisible:!1},a}return Object(b.a)(t,e),Object(A.a)(t,[{key:"render",value:function(){var e=this.state.isNavMenuVisible;return i.a.createElement("header",{className:"navbar has-shadow",role:"navigation","aria-label":"main navigation"},i.a.createElement("div",{className:"container"},i.a.createElement("div",{className:"navbar-brand"},i.a.createElement(h.b,{to:"/",className:"navbar-item has-text-weight-bold"},"My TV Shows"),i.a.createElement("a",{role:"button","data-target":"navMenu","aria-label":"menu","aria-expanded":"false",className:w()("navbar-burger",{"is-active":e}),onClick:this.toggleNavMenu},i.a.createElement("span",{"aria-hidden":"true"}),i.a.createElement("span",{"aria-hidden":"true"}),i.a.createElement("span",{"aria-hidden":"true"}))),i.a.createElement("div",{id:"navMenu",className:w()("navbar-menu",{"is-active":e})},i.a.createElement("div",{className:"navbar-start"},E.map(function(e){return i.a.createElement(h.c,{key:e.path,exact:e.exact,to:e.path,className:"navbar-item",activeClassName:"has-text-link"},e.title)})))))}}]),t}(i.a.Component),N=function(e){return i.a.createElement("div",null,i.a.createElement(y,null),i.a.createElement("main",{className:"container",style:{padding:"2em 0"}},e.children))},j=function(){return i.a.createElement(h.a,null,i.a.createElement(m.Helmet,{titleTemplate:"%s - My TV Shows"},i.a.createElement("meta",{name:"description",content:"A TMDb demo powered by React.js"})),i.a.createElement(N,null,E.map(function(e){return i.a.createElement(d.a,{key:e.path,path:e.path,exact:e.exact,component:e.component})})))},O=a(16);Object(s.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.b.auth.ensureAuthed();case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),O.b.auth.authNow(),e.abrupt("return");case 9:return e.next=11,Promise.all([O.b.account.syncInfo(),O.b.apiConf.syncConf()]);case 11:O.b.watchlist.syncWatchlist(),o.a.render(i.a.createElement(l.a,{store:O.a},i.a.createElement(j,null)),document.getElementById("root"));case 13:case"end":return e.stop()}},e,null,[[0,5]])}))()},91:function(e,t,a){"use strict";a.r(t);var n=a(5),r=a(6),s=a(10),c=a(9),i=a(11),u=a(0),o=a.n(u),l=a(18),m=a(14),h=(a(31),a(25)),d=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,i=new Array(r),u=0;u<r;u++)i[u]=arguments[u];return(a=Object(s.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).handleRemove=function(e){e.preventDefault(),a.props.onRemove(a.props.item.id)},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props.item;return o.a.createElement("div",{className:"card",style:{marginBottom:"1.5em"}},o.a.createElement("header",{className:"card-header"},o.a.createElement("p",{className:"card-header-title"},e.name," (",Object(h.a)(e.first_air_date),")"),o.a.createElement("a",{"aria-label":"remove from watchlist",className:"card-header-icon",onClick:this.handleRemove},o.a.createElement("span",{className:"icon"},o.a.createElement("i",{className:"fas fa-trash"})))),o.a.createElement("div",{className:"card-content"},o.a.createElement("p",{className:"content"},e.overview)))}}]),t}(o.a.Component),f=function(e){function t(){return Object(n.a)(this,t),Object(s.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.watchlist,a=e.rmFromWatchList;return o.a.createElement("section",null,o.a.createElement(l.Helmet,null,o.a.createElement("title",null,"Watchlist")),t.map(function(e){return o.a.createElement(d,{key:e.id,item:e,onRemove:a})}))}}]),t}(o.a.Component);t.default=Object(m.b)(function(e){return{watchlist:e.watchlist}},function(e){return{rmFromWatchList:function(t){return e.watchlist.rm(t)}}})(f)}},[[54,1,2]]]);
//# sourceMappingURL=main.f8da1022.chunk.js.map